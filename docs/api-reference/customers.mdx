---
title: Customers API
description: Customer management via Admin REST API
---

# Customers API

The Customers API provides administrative access to customer data through the WooCommerce REST API v3. This requires admin credentials (consumer key/secret).

## Access

```typescript
import { createTypewoo } from '@typewoo/sdk';

// Requires admin configuration
const sdk = createTypewoo({
  baseUrl: 'https://your-store.com',
  admin: {
    consumer_key: 'ck_xxx',
    consumer_secret: 'cs_xxx',
  },
});

const customerService = sdk.admin.customers;
```

## Methods

### `list(params?, options?)`

List customers with optional filters.

```typescript
const {
  data: customers,
  pagination,
  error,
} = await sdk.admin.customers.list({
  per_page: 20,
  page: 1,
  orderby: 'registered_date',
  order: 'desc',
});

customers?.forEach((customer) => {
  console.log(
    `${customer.first_name} ${customer.last_name} - ${customer.email}`
  );
});
```

**Query Parameters:**

| Parameter  | Type              | Description              |
| ---------- | ----------------- | ------------------------ |
| `page`     | `number`          | Page number              |
| `per_page` | `number`          | Items per page (max 100) |
| `search`   | `string`          | Search by email, name    |
| `exclude`  | `number[]`        | Exclude specific IDs     |
| `include`  | `number[]`        | Include specific IDs     |
| `offset`   | `number`          | Offset for pagination    |
| `order`    | `'asc' \| 'desc'` | Sort direction           |
| `orderby`  | `string`          | Sort field               |
| `email`    | `string`          | Filter by email          |
| `role`     | `string`          | Filter by role           |

**Returns:** `Promise<ApiPaginationResult<AdminCustomer[]>>`

### `getById(id, params?, options?)`

Get a single customer by ID.

```typescript
const { data: customer, error } = await sdk.admin.customers.getById(123);

if (customer) {
  console.log('Customer:', customer.email);
  console.log('Orders:', customer.orders_count);
  console.log('Total spent:', customer.total_spent);
}
```

**Parameters:**

| Name             | Type               | Required | Description       |
| ---------------- | ------------------ | -------- | ----------------- |
| `id`             | `number`           | Yes      | Customer ID       |
| `params.context` | `'view' \| 'edit'` | No       | Scope of response |

**Returns:** `Promise<ApiResult<AdminCustomer>>`

### `create(customer, options?)`

Create a new customer.

```typescript
const { data: customer, error } = await sdk.admin.customers.create({
  email: 'newcustomer@example.com',
  first_name: 'Jane',
  last_name: 'Smith',
  username: 'janesmith',
  password: 'securepassword123',
  billing: {
    first_name: 'Jane',
    last_name: 'Smith',
    company: 'ACME Inc',
    address_1: '456 Oak Ave',
    address_2: 'Suite 100',
    city: 'New York',
    state: 'NY',
    postcode: '10001',
    country: 'US',
    email: 'jane@example.com',
    phone: '+1987654321',
  },
  shipping: {
    first_name: 'Jane',
    last_name: 'Smith',
    company: 'ACME Inc',
    address_1: '456 Oak Ave',
    address_2: 'Suite 100',
    city: 'New York',
    state: 'NY',
    postcode: '10001',
    country: 'US',
  },
});

if (error) {
  console.error('Failed to create customer:', error.message);
} else {
  console.log('Created customer ID:', customer?.id);
}
```

**Returns:** `Promise<ApiResult<AdminCustomer>>`

### `update(id, customer, options?)`

Update an existing customer.

```typescript
const { data: customer, error } = await sdk.admin.customers.update(123, {
  first_name: 'Jane',
  last_name: 'Doe',
  billing: {
    phone: '+1555123456',
  },
});
```

**Parameters:**

| Name       | Type                   | Required | Description   |
| ---------- | ---------------------- | -------- | ------------- |
| `id`       | `number`               | Yes      | Customer ID   |
| `customer` | `AdminCustomerRequest` | Yes      | Customer data |

**Returns:** `Promise<ApiResult<AdminCustomer>>`

### `delete(id, force?, reassign?, options?)`

Delete a customer.

```typescript
// Move to trash
const { data, error } = await sdk.admin.customers.delete(123);

// Permanently delete
const { data, error } = await sdk.admin.customers.delete(123, true);

// Delete and reassign orders to another customer
const { data, error } = await sdk.admin.customers.delete(123, true, 456);
```

**Parameters:**

| Name       | Type      | Required | Description                         |
| ---------- | --------- | -------- | ----------------------------------- |
| `id`       | `number`  | Yes      | Customer ID                         |
| `force`    | `boolean` | No       | Permanently delete (default: false) |
| `reassign` | `number`  | No       | Reassign orders to this customer ID |

**Returns:** `Promise<ApiResult<AdminCustomer>>`

### `batch(operations, options?)`

Batch create, update, or delete customers.

```typescript
const { data, error } = await sdk.admin.customers.batch({
  create: [
    { email: 'user1@example.com', first_name: 'User', last_name: 'One' },
    { email: 'user2@example.com', first_name: 'User', last_name: 'Two' },
  ],
  update: [{ id: 123, first_name: 'Updated' }],
  delete: [456, 789],
});

console.log('Created:', data?.create.length);
console.log('Updated:', data?.update.length);
console.log('Deleted:', data?.delete.length);
```

**Returns:** `Promise<ApiResult<{ create: AdminCustomer[]; update: AdminCustomer[]; delete: AdminCustomer[] }>>`

### `downloads(id, options?)`

Get customer's available downloads.

```typescript
const { data: downloads, error } = await sdk.admin.customers.downloads(123);

downloads?.forEach((download) => {
  console.log(
    `${download.product_name}: ${download.downloads_remaining} remaining`
  );
});
```

**Returns:** `Promise<ApiResult<AdminCustomerDownload[]>>`

## Response Types

### AdminCustomer

```typescript
interface AdminCustomer {
  id: number;
  date_created: string;
  date_created_gmt: string;
  date_modified: string;
  date_modified_gmt: string;
  email: string;
  first_name: string;
  last_name: string;
  role: string;
  username: string;
  billing: CustomerAddress;
  shipping: CustomerAddress;
  is_paying_customer: boolean;
  avatar_url: string;
  meta_data: MetaData[];
  orders_count: number;
  total_spent: string;
}
```

### CustomerAddress

```typescript
interface CustomerAddress {
  first_name: string;
  last_name: string;
  company: string;
  address_1: string;
  address_2: string;
  city: string;
  state: string;
  postcode: string;
  country: string;
  email?: string; // Billing only
  phone?: string; // Billing only
}
```

### AdminCustomerDownload

```typescript
interface AdminCustomerDownload {
  download_id: string;
  download_url: string;
  product_id: number;
  product_name: string;
  download_name: string;
  order_id: number;
  order_key: string;
  downloads_remaining: string | number;
  access_expires: string;
  access_expires_gmt: string;
  file: {
    name: string;
    file: string;
  };
}
```

## Examples

### Search Customers

```typescript
async function searchCustomers(query: string) {
  const { data, pagination } = await sdk.admin.customers.list({
    search: query,
    per_page: 10,
  });

  return {
    customers: data || [],
    total: pagination.total,
  };
}
```

### Customer Lookup by Email

```typescript
async function findCustomerByEmail(email: string) {
  const { data } = await sdk.admin.customers.list({
    email,
    per_page: 1,
  });

  return data?.[0] || null;
}
```

### Create Customer with Validation

```typescript
async function createCustomer(data: CustomerFormData) {
  // Check if email already exists
  const existing = await findCustomerByEmail(data.email);
  if (existing) {
    throw new Error('Customer with this email already exists');
  }

  const { data: customer, error } = await sdk.admin.customers.create({
    email: data.email,
    first_name: data.firstName,
    last_name: data.lastName,
    billing: {
      first_name: data.firstName,
      last_name: data.lastName,
      email: data.email,
      phone: data.phone,
      address_1: data.address,
      city: data.city,
      state: data.state,
      postcode: data.postcode,
      country: data.country,
    },
    shipping: {
      first_name: data.firstName,
      last_name: data.lastName,
      address_1: data.address,
      city: data.city,
      state: data.state,
      postcode: data.postcode,
      country: data.country,
    },
  });

  if (error) {
    throw new Error(`Failed to create customer: ${error.message}`);
  }

  return customer;
}
```

### Export Customers

```typescript
async function* exportAllCustomers() {
  let page = 1;
  const perPage = 100;

  while (true) {
    const { data, pagination } = await sdk.admin.customers.list({
      page,
      per_page: perPage,
    });

    if (!data || data.length === 0) break;

    yield* data;

    if (!pagination.next) break;
    page++;
  }
}

// Usage
for await (const customer of exportAllCustomers()) {
  console.log(customer.email);
}
```

### Update Customer Address

```typescript
async function updateCustomerAddress(
  customerId: number,
  type: 'billing' | 'shipping',
  address: CustomerAddress
) {
  const { data, error } = await sdk.admin.customers.update(customerId, {
    [type]: address,
  });

  if (error) {
    throw new Error(`Failed to update address: ${error.message}`);
  }

  return data;
}
```

## Error Handling

```typescript
const { data, error } = await sdk.admin.customers.create(customerData);

if (error) {
  switch (error.code) {
    case 'registration-error-email-exists':
      showError('A customer with this email already exists');
      break;

    case 'registration-error-invalid-email':
      showError('Invalid email address');
      break;

    case 'registration-error-username-exists':
      showError('Username already taken');
      break;

    case 'woocommerce_rest_cannot_create':
      showError('Permission denied');
      break;

    default:
      showError(error.message);
  }
}
```

## Related Admin Services

### Coupons

```typescript
// List coupons
const { data } = await sdk.admin.coupons.list();

// Create coupon
const { data } = await sdk.admin.coupons.create({
  code: 'SUMMER2024',
  discount_type: 'percent',
  amount: '15',
  email_restrictions: ['vip@example.com'],
});
```

### Product Reviews

```typescript
// List reviews
const { data } = await sdk.admin.productReviews.list({
  product: [123],
});

// Create review
const { data } = await sdk.admin.productReviews.create({
  product_id: 123,
  review: 'Great product!',
  reviewer: 'John Doe',
  reviewer_email: 'john@example.com',
  rating: 5,
});
```

### Settings

```typescript
// Get all settings groups
const { data } = await sdk.admin.settings.list();

// Get specific group
const { data } = await sdk.admin.settings.getGroup('general');

// Update setting
const { data } = await sdk.admin.settings.updateOption(
  'general',
  'woocommerce_store_address',
  { value: '123 Main St' }
);
```

### Reports

```typescript
// Get sales report
const { data } = await sdk.admin.reports.getSales({
  date_min: '2024-01-01',
  date_max: '2024-12-31',
});

// Top sellers
const { data } = await sdk.admin.reports.getTopSellers({
  period: 'month',
});
```
